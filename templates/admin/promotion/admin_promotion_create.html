{% extends "admin/create_master.html" %}
{% load staticfiles %}
{% block hidden_content %}
<div id="id_promo_rule_initial">
<div>
<div style="padding: 10px;">
    <span>Add New Rule</span><span class="pull-right remove-item" style="cursor: pointer;"><i class="glyphicon glyphicon-close">X</i></span>
</div>
<table class="table">
    {{ rule_form.as_table }}
</table>
<br/>
</div>
</div>
<div id="id_promo_reward_initial">
<div>
<div style="padding: 10px;">
    <span>Add New Reward</span><span class="pull-right remove-item" style="cursor: pointer;"><i class="glyphicon glyphicon-close">X</i></span>
</div>
<table class="table">
    {{ reward_form.as_table }}
</table>
    <div>
    <div style="padding: 10px;">
        <span>Add Product</span><span class="pull-right remove-item" style="cursor: pointer;"><i class="glyphicon glyphicon-close">X</i></span>
    </div>
    <table class="table">
        {{ reward_product_form.as_table }}
    </table>
    <br/>
    </div>
<br/>
</div>
</div>
<div id="id_promo_reward_product_initial">
<div>
<div style="padding: 10px;">
    <span>Add Product</span><span class="pull-right remove-item" style="cursor: pointer;"><i class="glyphicon glyphicon-close">X</i></span>
</div>
<table class="table">
    {{ reward_product_form.as_table }}
</table>
<br/>
</div>
</div>
{% endblock hidden_content %}
{% block form_content %}
    <style type="text/css">
    .form-container {
        max-width: 100% !important;
    }
    .form-container input[type=checkbox] {
        width: 20px;
    }
    .form-container th {
        min-width: 80px;
    }
    .promo-heading {
        font-size: 17px;
        font-weight:bold;
    }
    </style>
    <div class="row">
        <div class="col-md-6">
            <h4 class="promo-heading">Basic Info</h4>
            <hr/>
            <table class="table" style="padding-right: 20px;">
                <tr>
                    <th>
                        Title:
                    </th>
                    <td>
                        {{ form.title }}
                    </td>
                </tr>
                <tr>
                    <th>
                        Description:
                    </th>
                    <td>
                        {{ form.description }}
                    </td>
                </tr>
                <tr>
                    <th>

                    </th>
                    <td>
                        {{ form.by_cart_hidden }}
                        <ul class="list-inline">
                            <li>
                                <label><input type="radio" name="promotion_by_cart" value="by_cart"/> By Cart</label>
                            </li>
                            <li>
                                <label><input type="radio" name="promotion_by_cart" value="by_product"/> By Product</label>
                            </li>
                            <li>
                                <label><input type="radio" name="promotion_by_cart" value="by_date"/> By Date</label>
                            </li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <th>

                    </th>
                    <td>
                        {{ form.by_amount_hidden }}
                        <ul class="list-inline">
                            <li>
                                <label><input type="radio" name="promotion_by_cart" value="by_amount"/> By Amount</label>
                            </li>
                            <li>
                                <label><input type="radio" name="promotion_by_cart" value="by_quantity"/> By Quantity</label>
                            </li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <th>
                        Currency:
                    </th>
                    <td>
                        {{ form.currency }}
                    </td>
                </tr>
                <tr>
                    <th>
                        Start Date:
                    </th>
                    <td>
                        {{ form.start_date }}
                    </td>
                </tr>
                <tr>
                    <th>
                        End Date:
                    </th>
                    <td>
                        {{ form.end_date }}
                    </td>
                </tr>
            </table>
        </div>
        <div class="col-md-6">
            <div class="row">
                <div class="col-md-12">
                    <h4 class="promo-heading">Promotion Rules</h4>
                    <hr/>
                    <div id="id_promo_rules">
                        <table class="table">
                        {{ rule_form.as_table }}
                        </table>
                    </div>
                    <a href="#" id="id_add_promo_rule" class="btn btn-default pull-right"><i class="glyphicon glyphicon-plus"></i> Add Rule</a>
                </div>
            </div>
            <br/>
            <div class="row">
                <div class="col-md-12">
                    <h4 class="promo-heading">Promotion Rewards</h4>
                    <hr/>
                    <div id="id_promo_rewards">
                        <table class="table">
                            {{ reward_form.as_table }}
                        </table>
                        <div>
                            <div class="promo_reward_product">
                                <div>
                                    <table class="table">
                                        {{ reward_product_form.as_table }}
                                    </table>
                                    <br/>
                                </div>
                            </div>
                            <a href="#" style="margin-bottom: 20px;" id="id_add_promo_reward_product"
                               class="btn btn-default"><i class="glyphicon glyphicon-plus"></i> Add Product</a>
                        </div>
                    </div>
                    <a href="#" id="id_add_promo_reward" class="btn btn-default pull-right"><i class="glyphicon glyphicon-plus"></i> Add Reward</a>
                </div>
            </div>
        </div>
    </div>
    <table class="table">
{#    {{ form.as_table }}#}
    </table>

<script type="text/javascript">
$(document).ready(function () {
    $("#id_start_date").datepicker();
    $("#id_end_date").datepicker();
    
    $("#id_add_promo_rule").click(function (e) {
        var rule_form_initial = $("#id_promo_rule_initial").html();
        $("#id_promo_rules").append(rule_form_initial);
        return false;
    });

    $("#id_add_promo_reward").click(function (e) {
        var form_initial = $("#id_promo_reward_initial").html();
        $("#id_promo_rewards").append(form_initial);
        return false;
    });

    $("#id_add_promo_reward_product").click(function (e) {
        var form_initial = $("#id_promo_reward_product_initial").html();
        $(this).parent().find(".promo_reward_product").append(form_initial);
        return false;
    });

    $(document).on("click", ".remove-item", function (e) {
        $(this).parent().parent().remove();
    })

});
</script>
{% endblock form_content %}